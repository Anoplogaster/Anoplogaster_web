# Convert PCA results to dataframe
pca_df <- as.data.frame(pca_result$x)  # PCA results are stored in the $x part of pca_result
# Ensure that meristics_labels matches the rows in pca_df
pca_df$Meristics <- meristics_labels  # Restore "Meristics" labels for later use
# Hierarchical Clustering
dist_matrix <- dist(scale(meristic_data))
hc <- hclust(dist_matrix, method = "ward.D2")
# Plot Dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = "", xlab = "", ylab = "Height")
rect.hclust(hc, k = 2, border = "red")
# K-Means Clustering
wss <- sapply(1:10, function(k) kmeans(scale(meristic_data), centers = k, nstart = 25)$tot.withinss)
# K-Means Clustering
wss <- sapply(1:11, function(k) kmeans(scale(meristic_data), centers = k, nstart = 25)$tot.withinss)
# K-Means Clustering
wss <- sapply(1:9, function(k) kmeans(scale(meristic_data), centers = k, nstart = 25)$tot.withinss)
# K-Means Clustering
wss <- sapply(1:1, function(k) kmeans(scale(meristic_data), centers = k, nstart = 25)$tot.withinss)
# K-Means Clustering
wss <- sapply(1:2, function(k) kmeans(scale(meristic_data), centers = k, nstart = 25)$tot.withinss)
# K-Means Clustering
wss <- sapply(1:6, function(k) kmeans(scale(meristic_data), centers = k, nstart = 25)$tot.withinss)
# K-Means Clustering
wss <- sapply(1:8, function(k) kmeans(scale(meristic_data), centers = k, nstart = 25)$tot.withinss)
# K-Means Clustering
max_k <- min(10, nrow(meristic_data))
wss <- sapply(1:max_k, function(k) {
kmeans(scale(meristic_data), centers = k, nstart = 25)$tot.withinss
})
# K-Means Clustering
max_k <- min(1, nrow(meristic_data))
wss <- sapply(1:max_k, function(k) {
kmeans(scale(meristic_data), centers = k, nstart = 25)$tot.withinss
})
plot(1:10, wss, type = "b", pch = 19, frame = FALSE, xlab = "Number of Clusters", ylab = "Within-cluster Sum of Squares")
wss <- sapply(1:max_k, function(k) {
kmeans(scale(meristic_data), centers = k, nstart = 25)$tot.withinss
})
plot(1:10, wss, type = "b", pch = 19, frame = FALSE, xlab = "Number of Clusters", ylab = "Within-cluster Sum of Squares")
plot(1:max_k, wss, type = "b", pch = 19, frame = FALSE, xlab = "Number of Clusters", ylab = "Within-cluster Sum of Squares")
wss <- sapply(1:max_k, function(k) {
kmeans(scale(meristic_data), centers = k, nstart = 25)$tot.withinss
})
plot(1:max_k, wss, type = "b", pch = 19, frame = FALSE, xlab = "Number of Clusters", ylab = "Within-cluster Sum of Squares")
# Run k-means with k=2 (adjust if elbow suggests a different k)
kmeans_result <- kmeans(scale(meristic_data), centers = 2, nstart = 25)
# Add cluster assignments to PCA dataframe
pca_df$Cluster <- as.factor(kmeans_result$cluster)
# Visualize clusters with labeled data points
ggplot(pca_df, aes(x = PC1, y = PC2, color = Cluster, label = Meristics)) +
geom_point(size = 3, alpha = 0.8) +
geom_text(vjust = -0.5, size = 3) +  # Adds labels above points
labs(title = "K-Means Clustering (k=2)", x = "PC1", y = "PC2", color = "Cluster") +
theme_minimal()
# Remove columns with only one unique value
meristic_data <- meristic_data[, sapply(meristic_data, function(x) length(unique(x)) > 1)]
# Perform PCA
pca_result <- prcomp(meristic_data, center = TRUE, scale. = TRUE)
# Convert PCA results to dataframe
pca_df <- as.data.frame(pca_result$x)  # PCA results are stored in the $x part of pca_result
# Ensure that meristics_labels matches the rows in pca_df
pca_df$Meristics <- meristics_labels  # Restore "Meristics" labels for later use
# Hierarchical Clustering
dist_matrix <- dist(scale(meristic_data))
hc <- hclust(dist_matrix, method = "ward.D2")
# Plot Dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = "", xlab = "", ylab = "Height")
rect.hclust(hc, k = 2, border = "red")
# K-Means Clustering
max_k <- min(1, nrow(meristic_data))
wss <- sapply(1:max_k, function(k) {
kmeans(scale(meristic_data), centers = k, nstart = 25)$tot.withinss
})
plot(1:max_k, wss, type = "b", pch = 19, frame = FALSE, xlab = "Number of Clusters", ylab = "Within-cluster Sum of Squares")
# Run k-means with k=2 (adjust if elbow suggests a different k)
kmeans_result <- kmeans(scale(meristic_data), centers = 2, nstart = 25)
# Add cluster assignments to PCA dataframe
pca_df$Cluster <- as.factor(kmeans_result$cluster)
# Visualize clusters with labeled data points
ggplot(pca_df, aes(x = PC1, y = PC2, color = Cluster, label = Meristics)) +
geom_point(size = 3, alpha = 0.8) +
geom_text(vjust = -0.5, size = 3) +  # Adds labels above points
labs(title = "K-Means Clustering (k=2)", x = "PC1", y = "PC2", color = "Cluster") +
theme_minimal()
meristic_data <- hatchetfish_data_log[, meristic_columns]
meristic_data <- na.omit(meristic_data)
# Create meristics_labels only for rows that are not removed by na.omit
meristics_labels <- hatchetfish_data_log$Meristics[rownames(meristic_data)]  # Use matching row names to align
# Convert remaining data to numeric
meristic_data[] <- lapply(meristic_data, function(x) as.numeric(as.character(x)))
# Remove columns with only one unique value
meristic_data <- meristic_data[, sapply(meristic_data, function(x) length(unique(x)) > 1)]
# Perform PCA
pca_result <- prcomp(meristic_data, center = TRUE, scale. = TRUE)
# Convert PCA results to dataframe
pca_df <- as.data.frame(pca_result$x)  # PCA results are stored in the $x part of pca_result
# Ensure that meristics_labels matches the rows in pca_df
pca_df$Meristics <- meristics_labels  # Restore "Meristics" labels for later use
# Hierarchical Clustering
dist_matrix <- dist(scale(meristic_data))
hc <- hclust(dist_matrix, method = "ward.D2")
# Plot Dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = "", xlab = "", ylab = "Height")
rect.hclust(hc, k = 2, border = "red")
# K-Means Clustering
wss <- sapply(1:10, function(k) kmeans(scale(meristic_data), centers = k, nstart = 25)$tot.withinss)
# K-Means Clustering
wss <- sapply(1:10, function(k) kmeans(scale(meristic_data), centers = k, nstart = 25)$tot.withinss)
# K-Means Clustering
max_k <- min(1, nrow(meristic_data))
# K-Means Clustering
max_k <- min(1, nrow(meristic_data))
wss <- sapply(1:max_k, function(k) {
kmeans(scale(meristic_data), centers = k, nstart = 25)$tot.withinss
})
plot(1:max_k, wss, type = "b", pch = 19, frame = FALSE, xlab = "Number of Clusters", ylab = "Within-cluster Sum of Squares")
# Run k-means with k=2 (adjust if elbow suggests a different k)
kmeans_result <- kmeans(scale(meristic_data), centers = 2, nstart = 25)
# Add cluster assignments to PCA dataframe
pca_df$Cluster <- as.factor(kmeans_result$cluster)
# Visualize clusters with labeled data points
ggplot(pca_df, aes(x = PC1, y = PC2, color = Cluster, label = Meristics)) +
geom_point(size = 3, alpha = 0.8) +
geom_text(vjust = -0.5, size = 3) +  # Adds labels above points
labs(title = "K-Means Clustering (k=2)", x = "PC1", y = "PC2", color = "Cluster") +
theme_minimal()
library(tidyr)
library(ggplot2)
library(ggrepel)
#Log transform
hatchetfish_data_log <- hatchetfish_data
hatchetfish_data_log[] <- lapply(hatchetfish_data_log, function(x) if(is.numeric(x)) log(x + 1) else x)
# Define meristic columns (excluding "Meristics" from the analysis)
meristic_columns <- c("Posttemporal.spine.length.HL", "Orbit.length.HL", "Snout.length.HL",
"Body.depth.SL", "Caudal.peduncle.length.SL", "Caudal.peduncle.depth.SL",
"Dorsal.fin.base.length.SL", "Anal.fin.base.length.SL", "Preanal.length.SL",
"Predorsal.length.SL", "Prepelvic.length.SL", "Postdorsal.length.SL",
"Postanal.length.SL", "Dorsal.pelvic.length.SL", "ACC.length.SL",
"ACB.ACC.length.SL", "OVB.1.height.SL", "OVB.2.height.SL", "OVB.3.height.SL",
"LP..Pigment.bar..length.SL")
meristic_data <- hatchetfish_data[, meristic_columns]
meristic_data <- na.omit(meristic_data)
#Enter your directory here Hannah!! (if you choose to)
hatchetfish_data <- read.csv(file.choose())
#Log transform
hatchetfish_data_log <- hatchetfish_data
hatchetfish_data_log[] <- lapply(hatchetfish_data_log, function(x) if(is.numeric(x)) log(x + 1) else x)
# Define meristic columns (excluding "Meristics" from the analysis)
meristic_columns <- c("Posttemporal.spine.length.HL", "Orbit.length.HL", "Snout.length.HL",
"Body.depth.SL", "Caudal.peduncle.length.SL", "Caudal.peduncle.depth.SL",
"Dorsal.fin.base.length.SL", "Anal.fin.base.length.SL", "Preanal.length.SL",
"Predorsal.length.SL", "Prepelvic.length.SL", "Postdorsal.length.SL",
"Postanal.length.SL", "Dorsal.pelvic.length.SL", "ACC.length.SL",
"ACB.ACC.length.SL", "OVB.1.height.SL", "OVB.2.height.SL", "OVB.3.height.SL",
"LP..Pigment.bar..length.SL")
meristic_data <- hatchetfish_data_log[, meristic_columns]
meristic_data <- na.omit(meristic_data)
# Create meristics_labels only for rows that are not removed by na.omit
meristics_labels <- hatchetfish_data_log$Meristics[rownames(meristic_data)]  # Use matching row names to align
# Convert remaining data to numeric
meristic_data[] <- lapply(meristic_data, function(x) as.numeric(as.character(x)))
# Remove columns with only one unique value
meristic_data <- meristic_data[, sapply(meristic_data, function(x) length(unique(x)) > 1)]
# Perform PCA
pca_result <- prcomp(meristic_data, center = TRUE, scale. = TRUE)
# Convert PCA results to dataframe
pca_df <- as.data.frame(pca_result$x)  # PCA results are stored in the $x part of pca_result
# Ensure that meristics_labels matches the rows in pca_df
pca_df$Meristics <- meristics_labels  # Restore "Meristics" labels for later use
# Hierarchical Clustering
dist_matrix <- dist(scale(meristic_data))
hc <- hclust(dist_matrix, method = "ward.D2")
# Plot Dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = "", xlab = "", ylab = "Height")
rect.hclust(hc, k = 2, border = "red")
# K-Means Clustering
max_k <- min(1, nrow(meristic_data))
wss <- sapply(1:max_k, function(k) {
kmeans(scale(meristic_data), centers = k, nstart = 25)$tot.withinss
})
plot(1:max_k, wss, type = "b", pch = 19, frame = FALSE, xlab = "Number of Clusters", ylab = "Within-cluster Sum of Squares")
# Run k-means with k=2 (adjust if elbow suggests a different k)
kmeans_result <- kmeans(scale(meristic_data), centers = 3, nstart = 25)
# Add cluster assignments to PCA dataframe
pca_df$Cluster <- as.factor(kmeans_result$cluster)
# Visualize clusters with labeled data points
ggplot(pca_df, aes(x = PC1, y = PC2, color = Cluster, label = Meristics)) +
geom_point(size = 3, alpha = 0.8) +
geom_text(vjust = -0.5, size = 3) +  # Adds labels above points
labs(title = "K-Means Clustering (k=2)", x = "PC1", y = "PC2", color = "Cluster") +
theme_minimal()
#Photophore counts
# Define meristic columns
meristic_columns <- c("Meristics","BR", "IP", "PV", "OP", "ORB", "SA", "SB", "SAB", "L", "VAV", "ACA", "ACB", "ACC")
# Visualize clusters with labeled data points
ggplot(pca_df, aes(x = PC1, y = PC2, color = Cluster, label = Meristics)) +
geom_point(size = 3, alpha = 0.8) +
geom_text(vjust = -0.5, size = 3) +  # Adds labels above points
labs(title = "K-Means Clustering (k=2)", x = "PC1", y = "PC2", color = "Cluster") +
theme_minimal()
library(ggrepel)
ggplot(pca_df, aes(x = PC1, y = PC2, color = Cluster, label = Meristics)) +
geom_point(size = 3, alpha = 0.8) +
geom_text_repel(size = 3, max.overlaps = 100) +
labs(title = "K-Means Clustering (k=2)", x = "PC1", y = "PC2", color = "Cluster") +
theme_minimal()
ggplot(pca_df, aes(x = PC1, y = PC2, color = Cluster)) +
geom_point(size = 3, alpha = 0.8) +
geom_text(aes(label = Meristics), vjust = -1, size = 3, color = "black") +
labs(title = "K-Means Clustering (k=2)", x = "PC1", y = "PC2", color = "Cluster") +
theme_minimal()
ggplot(pca_df, aes(x = PC1, y = PC2, color = Cluster)) +
geom_point(size = 3, alpha = 0.8) +
geom_text(aes(label = Meristics), vjust = -1, size = 3, color = "black") +
labs(title = "K-Means Clustering (k=2)", x = "PC1", y = "PC2", color = "Cluster") +
theme_minimal()
ggplot(pca_df, aes(x = PC1, y = PC2, color = Cluster)) +
geom_point(size = 3, alpha = 0.8) +
geom_text(aes(label = "Meristics"), vjust = -1, size = 3, color = "black") +
labs(title = "K-Means Clustering (k=2)", x = "PC1", y = "PC2", color = "Cluster") +
theme_minimal()
# Visualize clusters with labeled data points
ggplot(pca_df, aes(x = PC1, y = PC2, color = Cluster, label = Meristics)) +
geom_point(size = 3, alpha = 0.8) +
geom_text(vjust = -0.5, size = 3) +  # Adds labels above points
labs(title = "K-Means Clustering (k=2)", x = "PC1", y = "PC2", color = "Cluster") +
theme_minimal()
meristic_data
meristic_data <- hatchetfish_data[, meristic_columns]
meristic_data <- na.omit(meristic_data)
# Create meristics_labels only for rows that are not removed by na.omit
meristics_labels <- hatchetfish_data$Meristics[rownames(meristic_data)]  # Use matching row names to align
# Convert remaining data to numeric
meristic_data[] <- lapply(meristic_data, function(x) as.numeric(as.character(x)))
# Remove columns with only one unique value
meristic_data <- meristic_data[, sapply(meristic_data, function(x) length(unique(x)) > 1)]
# Perform PCA
pca_result <- prcomp(meristic_data, center = TRUE, scale. = TRUE)
# Convert PCA results to dataframe
pca_df <- as.data.frame(pca_result$x)  # PCA results are stored in the $x part of pca_result
# Perform PCA
pca_result <- prcomp(meristic_data, center = TRUE, scale. = TRUE)
# Convert PCA results to dataframe
pca_df <- as.data.frame(pca_result$x)  # PCA results are stored in the $x part of pca_result
# Ensure that meristics_labels matches the rows in pca_df
pca_df$Meristics <- meristics_labels  # Restore "Meristics" labels for later use
# Hierarchical Clustering
dist_matrix <- dist(scale(meristic_data))
hc <- hclust(dist_matrix, method = "ward.D2")
# Plot Dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = "", xlab = "", ylab = "Height")
rect.hclust(hc, k = 2, border = "red")
# Convert remaining data to numeric
meristic_data[] <- lapply(meristic_data, function(x) as.numeric(as.character(x)))
# Remove columns with only one unique value
meristic_data <- meristic_data[, sapply(meristic_data, function(x) length(unique(x)) > 1)]
meristic_data
# Define meristic columns (excluding "Meristics" from the analysis)
meristic_columns <- c("Posttemporal.spine.length.HL", "Orbit.length.HL", "Snout.length.HL",
"Body.depth.SL", "Caudal.peduncle.length.SL", "Caudal.peduncle.depth.SL",
"Dorsal.fin.base.length.SL", "Anal.fin.base.length.SL", "Preanal.length.SL",
"Predorsal.length.SL", "Prepelvic.length.SL", "Postdorsal.length.SL",
"Postanal.length.SL", "Dorsal.pelvic.length.SL", "ACC.length.SL",
"ACB.ACC.length.SL", "OVB.1.height.SL", "OVB.2.height.SL", "OVB.3.height.SL",
"LP..Pigment.bar..length.SL")
meristic_data <- hatchetfish_data[, meristic_columns]
meristic_data <- na.omit(meristic_data)
# Create meristics_labels only for rows that are not removed by na.omit
meristics_labels <- hatchetfish_data$Meristics[rownames(meristic_data)]  # Use matching row names to align
# Convert remaining data to numeric
meristic_data[] <- lapply(meristic_data, function(x) as.numeric(as.character(x)))
# Remove columns with only one unique value
meristic_data <- meristic_data[, sapply(meristic_data, function(x) length(unique(x)) > 1)]
# Perform PCA
pca_result <- prcomp(meristic_data, center = TRUE, scale. = TRUE)
# Convert PCA results to dataframe
pca_df <- as.data.frame(pca_result$x)  # PCA results are stored in the $x part of pca_result
# Ensure that meristics_labels matches the rows in pca_df
pca_df$Meristics <- meristics_labels  # Restore "Meristics" labels for later use
meristic_data
# Create meristics_labels only for rows that are not removed by na.omit
meristics_labels <- hatchetfish_data_log[rownames(meristic_data), "Meristics"]
# Convert remaining data to numeric
meristic_data[] <- lapply(meristic_data, function(x) as.numeric(as.character(x)))
# Remove columns with only one unique value
meristic_data <- meristic_data[, sapply(meristic_data, function(x) length(unique(x)) > 1)]
# Perform PCA
pca_result <- prcomp(meristic_data, center = TRUE, scale. = TRUE)
# Convert PCA results to dataframe
pca_df <- as.data.frame(pca_result$x)  # PCA results are stored in the $x part of pca_result
# Ensure that meristics_labels matches the rows in pca_df
pca_df$Meristics <- meristics_labels  # Restore "Meristics" labels for later use
# Hierarchical Clustering
dist_matrix <- dist(scale(meristic_data))
hc <- hclust(dist_matrix, method = "ward.D2")
# Plot Dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = "", xlab = "", ylab = "Height")
rect.hclust(hc, k = 2, border = "red")
# K-Means Clustering
max_k <- min(1, nrow(meristic_data))
wss <- sapply(1:max_k, function(k) {
kmeans(scale(meristic_data), centers = k, nstart = 25)$tot.withinss
})
plot(1:max_k, wss, type = "b", pch = 19, frame = FALSE, xlab = "Number of Clusters", ylab = "Within-cluster Sum of Squares")
# Run k-means with k=2 (adjust if elbow suggests a different k)
kmeans_result <- kmeans(scale(meristic_data), centers = 2, nstart = 25)
# Add cluster assignments to PCA dataframe
pca_df$Cluster <- as.factor(kmeans_result$cluster)
# Visualize clusters with labeled data points
ggplot(pca_df, aes(x = PC1, y = PC2, color = Cluster, label = Meristics)) +
geom_point(size = 3, alpha = 0.8) +
geom_text(vjust = -0.5, size = 3) +  # Adds labels above points
labs(title = "K-Means Clustering (k=2)", x = "PC1", y = "PC2", color = "Cluster") +
theme_minimal()
meristic_data <- hatchetfish_data_log[, meristic_columns]
meristic_data <- na.omit(meristic_data)
# Create meristics_labels only for rows that are not removed by na.omit
meristics_labels <- hatchetfish_data_log$Meristics[rownames(meristic_data)]  # Use matching row names to align
# Visualize clusters with labeled data points
ggplot(pca_df, aes(x = PC1, y = PC2, color = Cluster, label = Meristics)) +
geom_point(size = 3, alpha = 0.8) +
geom_text(vjust = -0.5, size = 3) +
labs(title = "K-Means Clustering (k=2)", x = "PC1", y = "PC2", color = "Cluster") +
theme_minimal()
meristic_data <- hatchetfish_data_log[, meristic_columns]
meristic_data <- na.omit(meristic_data)
# Create meristics_labels only for rows that are not removed by na.omit
meristics_labels <- hatchetfish_data_log$Meristics[rownames(meristic_data)]  # Use matching row names to align
# Convert remaining data to numeric
meristic_data[] <- lapply(meristic_data, function(x) as.numeric(as.character(x)))
# Remove columns with only one unique value
meristic_data <- meristic_data[, sapply(meristic_data, function(x) length(unique(x)) > 1)]
# Perform PCA
pca_result <- prcomp(meristic_data, center = TRUE, scale. = TRUE)
# Convert PCA results to dataframe
pca_df <- as.data.frame(pca_result$x)  # PCA results are stored in the $x part of pca_result
# Ensure that meristics_labels matches the rows in pca_df
pca_df$Meristics <- meristics_labels  # Restore "Meristics" labels for later use
# Hierarchical Clustering
dist_matrix <- dist(scale(meristic_data))
hc <- hclust(dist_matrix, method = "ward.D2")
# Plot Dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = "", xlab = "", ylab = "Height")
rect.hclust(hc, k = 2, border = "red")
# K-Means Clustering
max_k <- min(1, nrow(meristic_data))
wss <- sapply(1:max_k, function(k) {
kmeans(scale(meristic_data), centers = k, nstart = 25)$tot.withinss
})
plot(1:max_k, wss, type = "b", pch = 19, frame = FALSE, xlab = "Number of Clusters", ylab = "Within-cluster Sum of Squares")
# Run k-means with k=2 (adjust if elbow suggests a different k)
kmeans_result <- kmeans(scale(meristic_data), centers = 3, nstart = 25)
# Add cluster assignments to PCA dataframe
pca_df$Cluster <- as.factor(kmeans_result$cluster)
# Visualize clusters with labeled data points
ggplot(pca_df, aes(x = PC1, y = PC2, color = Cluster, label = Meristics)) +
geom_point(size = 3, alpha = 0.8) +
geom_text(vjust = -0.5, size = 3) +  # Adds labels above points
labs(title = "K-Means Clustering (k=2)", x = "PC1", y = "PC2", color = "Cluster") +
theme_minimal()
# Visualize clusters with labeled data points
ggplot(pca_df, aes(x = PC1, y = PC2, color = Cluster, label = Meristics)) +
geom_point(size = 3, alpha = 0.8) +
geom_text(vjust = -0.5, size = 3) +
labs(title = "K-Means Clustering (k=2)", x = "PC1", y = "PC2", color = "Cluster") +
theme_minimal()
# Define meristic columns (excluding "Meristics" from the analysis)
meristic_columns <- c("Posttemporal.spine.length.HL", "Orbit.length.HL", "Snout.length.HL",
"Body.depth.SL", "Caudal.peduncle.length.SL", "Caudal.peduncle.depth.SL",
"Dorsal.fin.base.length.SL", "Anal.fin.base.length.SL", "Preanal.length.SL",
"Predorsal.length.SL", "Prepelvic.length.SL", "Postdorsal.length.SL",
"Postanal.length.SL", "Dorsal.pelvic.length.SL", "ACC.length.SL",
"ACB.ACC.length.SL", "OVB.1.height.SL", "OVB.2.height.SL", "OVB.3.height.SL",
"LP..Pigment.bar..length.SL")
meristic_data <- hatchetfish_data[, meristic_columns]
meristic_data <- na.omit(meristic_data)
# Create meristics_labels only for rows that are not removed by na.omit
meristics_labels <- hatchetfish_data_log[rownames(meristic_data), "Meristics"]
# Convert remaining data to numeric
meristic_data[] <- lapply(meristic_data, function(x) as.numeric(as.character(x)))
# Remove columns with only one unique value
meristic_data <- meristic_data[, sapply(meristic_data, function(x) length(unique(x)) > 1)]
# Perform PCA
pca_result <- prcomp(meristic_data, center = TRUE, scale. = TRUE)
# Convert PCA results to dataframe
pca_df <- as.data.frame(pca_result$x)  # PCA results are stored in the $x part of pca_result
# Ensure that meristics_labels matches the rows in pca_df
pca_df$Meristics <- meristics_labels  # Restore "Meristics" labels for later use
# Hierarchical Clustering
dist_matrix <- dist(scale(meristic_data))
hc <- hclust(dist_matrix, method = "ward.D2")
# Plot Dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = "", xlab = "", ylab = "Height")
rect.hclust(hc, k = 2, border = "red")
# K-Means Clustering
max_k <- min(1, nrow(meristic_data))
wss <- sapply(1:max_k, function(k) {
kmeans(scale(meristic_data), centers = k, nstart = 25)$tot.withinss
})
plot(1:max_k, wss, type = "b", pch = 19, frame = FALSE, xlab = "Number of Clusters", ylab = "Within-cluster Sum of Squares")
# Run k-means with k=2 (adjust if elbow suggests a different k)
kmeans_result <- kmeans(scale(meristic_data), centers = 2, nstart = 25)
wss <- sapply(1:max_k, function(k) {
kmeans(scale(meristic_data), centers = k, nstart = 25)$tot.withinss
})
plot(1:max_k, wss, type = "b", pch = 19, frame = FALSE, xlab = "Number of Clusters", ylab = "Within-cluster Sum of Squares")
# Run k-means with k=2 (adjust if elbow suggests a different k)
kmeans_result <- kmeans(scale(meristic_data), centers = 2, nstart = 25)
# Add cluster assignments to PCA dataframe
pca_df$Cluster <- as.factor(kmeans_result$cluster)
# Visualize clusters with labeled data points
ggplot(pca_df, aes(x = PC1, y = PC2, color = Cluster, label = Meristics)) +
geom_point(size = 3, alpha = 0.8) +
geom_text(vjust = -0.5, size = 3) +
labs(title = "K-Means Clustering (k=2)", x = "PC1", y = "PC2", color = "Cluster") +
theme_minimal()
head(rownames(meristic_data))
head(rownames(hatchetfish_data_log))
# Extract meristic data (log or not, same logic)
meristic_data <- hatchetfish_data[, meristic_columns]
# Identify complete cases before dropping rows
complete_idx <- complete.cases(meristic_data)
# Keep only complete cases
meristic_data <- meristic_data[complete_idx, ]
# Match the Meristics labels from the *log-transformed* data if needed
meristics_labels <- hatchetfish_data_log$Meristics[complete_idx]
# Convert remaining data to numeric
meristic_data[] <- lapply(meristic_data, function(x) as.numeric(as.character(x)))
# Remove columns with only one unique value
meristic_data <- meristic_data[, sapply(meristic_data, function(x) length(unique(x)) > 1)]
# Perform PCA
pca_result <- prcomp(meristic_data, center = TRUE, scale. = TRUE)
# Convert PCA results to dataframe
pca_df <- as.data.frame(pca_result$x)  # PCA results are stored in the $x part of pca_result
# Ensure that meristics_labels matches the rows in pca_df
pca_df$Meristics <- meristics_labels  # Restore "Meristics" labels for later use
# Hierarchical Clustering
dist_matrix <- dist(scale(meristic_data))
hc <- hclust(dist_matrix, method = "ward.D2")
# Plot Dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = "", xlab = "", ylab = "Height")
rect.hclust(hc, k = 2, border = "red")
# K-Means Clustering
max_k <- min(1, nrow(meristic_data))
wss <- sapply(1:max_k, function(k) {
kmeans(scale(meristic_data), centers = k, nstart = 25)$tot.withinss
})
plot(1:max_k, wss, type = "b", pch = 19, frame = FALSE, xlab = "Number of Clusters", ylab = "Within-cluster Sum of Squares")
# Run k-means with k=2 (adjust if elbow suggests a different k)
kmeans_result <- kmeans(scale(meristic_data), centers = 2, nstart = 25)
# Add cluster assignments to PCA dataframe
pca_df$Cluster <- as.factor(kmeans_result$cluster)
# Visualize clusters with labeled data points
ggplot(pca_df, aes(x = PC1, y = PC2, color = Cluster, label = Meristics)) +
geom_point(size = 3, alpha = 0.8) +
geom_text(vjust = -0.5, size = 3) +
labs(title = "K-Means Clustering (k=2)", x = "PC1", y = "PC2", color = "Cluster") +
theme_minimal()
meristic_data <- hatchetfish_data_log[, meristic_columns]
meristic_data <- na.omit(meristic_data)
# Create meristics_labels only for rows that are not removed by na.omit
meristics_labels <- hatchetfish_data_log$Meristics[rownames(meristic_data)]  # Use matching row names to align
# Convert remaining data to numeric
meristic_data[] <- lapply(meristic_data, function(x) as.numeric(as.character(x)))
# Remove columns with only one unique value
meristic_data <- meristic_data[, sapply(meristic_data, function(x) length(unique(x)) > 1)]
# Perform PCA
pca_result <- prcomp(meristic_data, center = TRUE, scale. = TRUE)
# Convert PCA results to dataframe
pca_df <- as.data.frame(pca_result$x)  # PCA results are stored in the $x part of pca_result
# Ensure that meristics_labels matches the rows in pca_df
pca_df$Meristics <- meristics_labels  # Restore "Meristics" labels for later use
# Hierarchical Clustering
dist_matrix <- dist(scale(meristic_data))
hc <- hclust(dist_matrix, method = "ward.D2")
# Plot Dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = "", xlab = "", ylab = "Height")
rect.hclust(hc, k = 2, border = "red")
# K-Means Clustering
max_k <- min(1, nrow(meristic_data))
wss <- sapply(1:max_k, function(k) {
kmeans(scale(meristic_data), centers = k, nstart = 25)$tot.withinss
})
plot(1:max_k, wss, type = "b", pch = 19, frame = FALSE, xlab = "Number of Clusters", ylab = "Within-cluster Sum of Squares")
# Run k-means with k=2 (adjust if elbow suggests a different k)
kmeans_result <- kmeans(scale(meristic_data), centers = 3, nstart = 25)
# Add cluster assignments to PCA dataframe
pca_df$Cluster <- as.factor(kmeans_result$cluster)
# Visualize clusters with labeled data points
ggplot(pca_df, aes(x = PC1, y = PC2, color = Cluster, label = Meristics)) +
geom_point(size = 3, alpha = 0.8) +
geom_text(vjust = -0.5, size = 3) +
labs(title = "K-Means Clustering (k=2)", x = "PC1", y = "PC2", color = "Cluster") +
theme_minimal()
#Photophore counts
# Define meristic columns
meristic_columns <- c("Meristics","BR", "IP", "PV", "OP", "ORB", "SA", "SB", "SAB", "L", "VAV", "ACA", "ACB", "ACC")
# Extract meristic data and remove NAs
meristic_data <- hatchetfish_data[, meristic_columns]
install.packages("blogdown")
blogdown::install_hugo()
blogdown::serve_site()
gc()
setwd("~/anoplogaster_website")
blogdown::serve_site()
cd
ls
setwd("/Users/alexmaile/anoplogaster_website")
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
ls
